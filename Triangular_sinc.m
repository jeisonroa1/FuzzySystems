clear;
clc;


%Autores:   Pablo Narvaez
 %          Alexander Pineda
 %          Felipe Bernal
         
% med=[-12 -9 -4.5 0 4.5 9 12]';
% dev=[1.6 1.8 1.6 1.6 1.6 1.8 1.6]';
% % med = [9.023931;   
% %   -4.7939546;  
% %     1.6157398;  
% %   -2.9722281;  
% %   -2.9705283;  
% %   -5.9069491;  
% %     3.4983139;  
% %   -0.0533782;  
% %     9.3089656;  
% %   -10.151882;  
% %   -5.5754622;  
% %   -0.9835214;  
% %   -9.6341722;  
% %   -5.8490156;  
% %   -4.2787547;  
% %     0.8262493];
% % 
% % dev = [-8.1034606;  
% %     0.8102263;  
% %   -1.6583605;  
% %     10.563112;  
% %   -3.1162058;  
% %   -4.7174939;  
% %   -7.7363655;  
% %   -10.514792;  
% %   -4.2260227;  
% %     2.4887734;  
% %   -0.5930367;  
% %   -0.6474428;  
% %   -1.6990074;  
% %   -10.22119;   
% %   -2.9313666;  
% %   -12.717532];
%  y=[-0.4 0.2 -0.25 1.05 -0.25 0.2 -0.04]';
% % y = [-8.4534755;  
% %     4.1222093;  
% %     9.1881052;  
% %     0.4357197;  
% %   -6.880497;   
% %   -3.3574947;  
% %     1.7847892;  
% %     11.830628;  
% %   -0.1091208;  
% %     3.0785173;  
% %     5.9268079;  
% %   -6.4857878;  
% %     2.3974981;  
% %     2.1090877;  
% %   -5.8017141;  
% %   -6.305453];
b=2.3; 
med=[-10 -9 -8 -7 -6 -4.6 -4 -3 -2 -1 0 1 2 3 4 4.6 6 7 8 9 10]';
dev=[b b b b b b b b b b b b b b b b b b b b b]';
y=[-0.105 0.14 0.21 0.09 -0.21 -0.31 -0.21 0.1 0.5 0.8 1.38 0.8 0.5 0.1 -0.21 -0.31 -0.21 0.09 0.21 0.14 -0.105]';


u=-10:0.5:10;
for k=1:length(u),
x=u(1,k);
m=length(y);
n=length(x);
z=1;
for i=1:m,
  for j=1:n,
    xp=x(1,j);
    mp=med(i,j);
    dp=dev(i,j);
    f=max(0,1-abs((xp-mp)/(dp)));
    %f=exp((-0.5*(xp-mp)^2)/(dp^2));
    z=z*f;
  end;
  rul(i,1)=z;
  z=1;
end;
b=sum(rul);

for q=1:m,
  fbd(q,k)=rul(q,1)/b;
end
end;

for p=1:m,
  rw(p,:)=y(p,1)*fbd(p,:);
end;

plot(u,fbd);

figure

plot(u,rw);

efbd=sum(rw,1);

figure

fy=sinc(0.3*u)

plot(u,efbd);
hold;
plot(u,fy,'r');

